
## mr_utils.sim.gre.gre

[Source](https://github.com/mckib2/mr_utils/blob/master/mr_utils/sim/gre/gre.py)

```
NAME
    mr_utils.sim.gre.gre

FUNCTIONS
    ernst(TR, T1)
        Computes the Ernst angle.
        
        TR -- repetition time.
        T1 -- longitudinal exponential decay time constant.
        
        Implements equation [14.9] from:
            Notes from Bernstein, M. A., King, K. F., & Zhou, X. J. (2004).
            Handbook of MRI pulse sequences. Elsevier.
    
    fzss(T1, TR, alpha=None)
        Dimensionless measure of steady-state longitudinal magnetization.
        
        T1 -- longitudinal exponential decay time constant.
        TR -- repetition time.
        alpha -- flip angle.
        
        alpha=None will use the Ernst angle.
        
        Implements equation [14.7] from:
            Notes from Bernstein, M. A., King, K. F., & Zhou, X. J. (2004).
            Handbook of MRI pulse sequences. Elsevier.
    
    gre_sim(T1, T2, TR=0.012, TE=0.006, alpha=1.0471975511965976, field_map=None, phi=0, dphi=0, M0=1, tol=1e-05, iter=None, spoil=True)
        Simulate GRE pulse sequence.
        
        T1 -- longitudinal exponential decay time constant.
        T2 -- Transverse exponential decay time constant.
        TR -- repetition time.
        TE -- echo time.
        alpha -- flip angle.
        field_map -- offresonance field map (in hertz).
        phi -- Reference starting phase.
        dphi -- phase  cycling of RF pulses.
        M0 -- proton density.
        tol -- Maximum difference between voxel intensity iter to iter until stop.
        iter -- number of excitations till steady state.
        
        iter=None will run until difference between all voxel intensities iteration
        to iteration is within given tolerance, tol (default=1e-5).
        
        Returns complex transverse magnetization (Mx + 1j*My)
    
    gre_sim_loop(T1, T2, TR=0.012, TE=0.006, alpha=1.0471975511965976, field_map=None, dphi=0, M0=1, iter=200)
        Simulate GRE pulse sequence.
        
        T1 -- longitudinal exponential decay time constant.
        T2 -- Transverse exponential decay time constant.
        TR -- repetition time.
        TE -- echo time.
        alpha -- flip angle.
        field_map -- offresonance field map (in hertz).
        dphi -- phase  cycling of RF pulses.
        M0 -- proton density.
        iter -- number of excitations till steady state.
    
    spoiled_gre(T1, T2star, TR, TE, alpha=None, M0=1)
        Spoiled, steady state GRE contrast simulation.
        
        T1 -- longitudinal exponential decay time constant.
        T2star -- Effective transverse exponential decay time constant.
        TR -- repetition time.
        TE -- echo time.
        alpha -- flip angle.
        M0 -- proton density.
        
        alpha=None will use the Ernst angle.
        
        Assuming a longitudinal steady-state and perfect spoiling. Note that
        dependence is on T2* rather than T2 because SE/STE formation is suppressed
        by spoiling and the signal is generated by gradient refocusing of an FID.
        
        Implements equation [14.8] from:
            Notes from Bernstein, M. A., King, K. F., & Zhou, X. J. (2004).
            Handbook of MRI pulse sequences. Elsevier.
    
    spoiled_gre_k(T1, T2star, TR, TE, alpha=None, M0=1, k=1)
        Spoiled GRE contrast simulation for k excitation pulses.
        
        See spoiled_gre().
        k -- Number of excitation pulses the magnetization experiences.
        
        alpha=None will use the Ernst angle.
        
        Implements equations [14.10-11] from:
            Notes from Bernstein, M. A., King, K. F., & Zhou, X. J. (2004).
            Handbook of MRI pulse sequences. Elsevier.


```

